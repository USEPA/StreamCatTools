<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>National Nutrient Inventory (NNI) Data in StreamCat • StreamCatTools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../../favicon.ico">
<link rel="manifest" href="../../site.webmanifest">
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../../deps/headroom-0.11.0/headroom.min.js"></script><script src="../../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../../deps/search-1.0.0/fuse.min.js"></script><script src="../../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="National Nutrient Inventory (NNI) Data in StreamCat">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../../index.html">StreamCatTools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.10.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../../articles/StartHere.html">Start Here</a></li>
    <li><a class="dropdown-item" href="../../articles/Articles/Introduction.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../../articles/Articles/LakeCat.html">Working with LakeCat data</a></li>
    <li><a class="dropdown-item" href="../../articles/Articles/NNI.html">National Nutrient Inventory (NNI) Data in StreamCat</a></li>
    <li><a class="dropdown-item" href="../../articles/Articles/Applications.html">Applications</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/USEPA/StreamCatTools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../../logo.png" class="logo" alt=""><h1>National Nutrient Inventory (NNI) Data in StreamCat</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/USEPA/StreamCatTools/blob/HEAD/vignettes/Articles/NNI.Rmd" class="external-link"><code>vignettes/Articles/NNI.Rmd</code></a></small>
      <div class="d-none name"><code>NNI.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="use-sc_plotnni-and-lc_plotnni">Use sc_plotnni and lc_plotnni<a class="anchor" aria-label="anchor" href="#use-sc_plotnni-and-lc_plotnni"></a>
</h2>
<p>In the following examples, we use <code>sc_plotnni</code> and
<code>lc_plotnni</code> functions to plot annual time series of nitrogen
and phosphorus budget data for a given watershed. These data are plotted
from 1990-2017. Hatching on the bars is reflective of data linearly
interpolated between agricultural census years.</p>
<p>Mississippi-Atchafalaya River Basin</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://usepa.github.io/StreamCatTools/">StreamCatTools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/trevorld/ggpattern" class="external-link">ggpattern</a></span><span class="op">)</span></span>
<span><span class="va">com</span> <span class="op">&lt;-</span> <span class="st">'22812041'</span></span>
<span><span class="fu"><a href="../../reference/sc_plotnni.html">sc_plotnni</a></span><span class="op">(</span>comid <span class="op">=</span> <span class="va">com</span>, include.nue <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="NNI_files/figure-html/unnamed-chunk-2-1.png" class="r-plt" alt="" width="700"></p>
<p>Neuse River, North Carolina</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">com</span> <span class="op">&lt;-</span> <span class="st">'10975909'</span></span>
<span><span class="fu"><a href="../../reference/sc_plotnni.html">sc_plotnni</a></span><span class="op">(</span>comid <span class="op">=</span> <span class="va">com</span><span class="op">)</span></span></code></pre></div>
<p><img src="NNI_files/figure-html/unnamed-chunk-3-1.png" class="r-plt" alt="" width="700"></p>
<p>Lake Kanasatka, New Hampshire</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">com</span> <span class="op">=</span> <span class="st">'6738112'</span></span>
<span><span class="fu"><a href="../../reference/lc_plotnni.html">lc_plotnni</a></span><span class="op">(</span>comid <span class="op">=</span> <span class="va">com</span><span class="op">)</span></span></code></pre></div>
<p><img src="NNI_files/figure-html/unnamed-chunk-4-1.png" class="r-plt" alt="" width="700">
## Use sc_get_nni and lc_get_nni to pull NNI budget data In these
examples, we access all available NNI metrics for user-defined years.
Most NNI metrics are available from 1987 to 2017, except for nitrogen
deposition, phosphorus deposition, and nitrogen and phosphorus point
source loads. These metrics are returned for available years.</p>
</div>
<div class="section level2">
<h2 id="cuyahoga-river">Cuyahoga River<a class="anchor" aria-label="anchor" href="#cuyahoga-river"></a>
</h2>
<p>Return dataframe of NNI metrics for Cuyahoga River</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">com</span> <span class="op">&lt;-</span> <span class="fl">15588532</span></span>
<span><span class="va">years</span> <span class="op">&lt;-</span> <span class="st">'1987, 1992, 1997, 2002, 2007, 2012, 2017'</span></span>
<span><span class="va">cuyahoga</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sc_get_nni.html">sc_get_nni</a></span><span class="op">(</span>year<span class="op">=</span><span class="va">years</span>,</span>
<span>           comid<span class="op">=</span><span class="va">com</span>,</span>
<span>           aoi<span class="op">=</span><span class="st">'ws'</span>,</span>
<span>           showAreaSqKm<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cuyahoga</span><span class="op">)</span></span>
<span><span class="co">#&gt;   [1] "comid"           "n_ff_1992ws"     "n_ff_1997ws"     "n_ff_2002ws"    </span></span>
<span><span class="co">#&gt;   [5] "n_ff_2007ws"     "n_ff_2012ws"     "n_ff_2017ws"     "p_ff_1987ws"    </span></span>
<span><span class="co">#&gt;   [9] "p_ff_1992ws"     "p_ff_1997ws"     "p_ff_2002ws"     "p_ff_2007ws"    </span></span>
<span><span class="co">#&gt;  [13] "p_ff_2012ws"     "p_ff_2017ws"     "n_ff_1987ws"     "n_uf_1987ws"    </span></span>
<span><span class="co">#&gt;  [17] "n_uf_1992ws"     "n_uf_1997ws"     "n_uf_2002ws"     "n_uf_2007ws"    </span></span>
<span><span class="co">#&gt;  [21] "n_uf_2012ws"     "n_uf_2017ws"     "p_uf_1987ws"     "p_uf_1992ws"    </span></span>
<span><span class="co">#&gt;  [25] "p_uf_1997ws"     "p_uf_2002ws"     "p_uf_2007ws"     "p_uf_2012ws"    </span></span>
<span><span class="co">#&gt;  [29] "p_uf_2017ws"     "n_ags_1987ws"    "n_ags_1992ws"    "n_ags_1997ws"   </span></span>
<span><span class="co">#&gt;  [33] "n_ags_2002ws"    "n_lw_1987ws"     "n_lw_1992ws"     "n_lw_1997ws"    </span></span>
<span><span class="co">#&gt;  [37] "n_lw_2002ws"     "n_lw_2007ws"     "n_lw_2012ws"     "n_lw_2017ws"    </span></span>
<span><span class="co">#&gt;  [41] "p_lw_1987ws"     "p_lw_1992ws"     "p_lw_1997ws"     "p_lw_2002ws"    </span></span>
<span><span class="co">#&gt;  [45] "n_cr_1992ws"     "n_cr_1997ws"     "n_cr_2002ws"     "n_cr_2007ws"    </span></span>
<span><span class="co">#&gt;  [49] "n_cr_2012ws"     "n_cr_2017ws"     "p_cr_1987ws"     "p_cr_1992ws"    </span></span>
<span><span class="co">#&gt;  [53] "p_cr_1997ws"     "p_cr_2002ws"     "p_cr_2007ws"     "p_cr_2012ws"    </span></span>
<span><span class="co">#&gt;  [57] "p_cr_2017ws"     "n_cr_1987ws"     "n_ags_2012ws"    "n_ags_2017ws"   </span></span>
<span><span class="co">#&gt;  [61] "p_ags_1987ws"    "p_ags_1992ws"    "p_ags_1997ws"    "p_ags_2002ws"   </span></span>
<span><span class="co">#&gt;  [65] "p_ags_2007ws"    "p_ags_2012ws"    "p_ags_2017ws"    "n_cf_1987ws"    </span></span>
<span><span class="co">#&gt;  [69] "n_cf_1992ws"     "n_cf_1997ws"     "n_cf_2002ws"     "n_ags_2007ws"   </span></span>
<span><span class="co">#&gt;  [73] "n_cf_2007ws"     "n_cf_2012ws"     "n_cf_2017ws"     "p_lw_2007ws"    </span></span>
<span><span class="co">#&gt;  [77] "p_lw_2012ws"     "p_lw_2017ws"     "n_hw_1987ws"     "n_hw_1992ws"    </span></span>
<span><span class="co">#&gt;  [81] "n_hw_1997ws"     "n_hw_2002ws"     "n_hw_2007ws"     "n_hw_2012ws"    </span></span>
<span><span class="co">#&gt;  [85] "n_hw_2017ws"     "p_hw_1987ws"     "p_hw_1992ws"     "p_hw_1997ws"    </span></span>
<span><span class="co">#&gt;  [89] "p_hw_2002ws"     "p_hw_2007ws"     "p_hw_2012ws"     "p_hw_2017ws"    </span></span>
<span><span class="co">#&gt;  [93] "p_dep_1997ws"    "p_dep_2002ws"    "p_dep_2007ws"    "p_dep_2012ws"   </span></span>
<span><span class="co">#&gt;  [97] "n_usgsww_1992ws" "n_usgsww_2012ws" "p_usgsww_1992ws" "p_usgsww_2012ws"</span></span>
<span><span class="co">#&gt; [101] "n_leg_1987ws"    "n_leg_1992ws"    "n_leg_1997ws"    "n_leg_2002ws"   </span></span>
<span><span class="co">#&gt; [105] "n_leg_2007ws"    "n_leg_2012ws"    "n_leg_2017ws"    "p_leg_1987ws"   </span></span>
<span><span class="co">#&gt; [109] "p_leg_1992ws"    "p_leg_1997ws"    "p_leg_2002ws"    "p_leg_2007ws"   </span></span>
<span><span class="co">#&gt; [113] "p_leg_2012ws"    "p_leg_2017ws"    "n_dep_1992ws"    "n_dep_1997ws"   </span></span>
<span><span class="co">#&gt; [117] "n_dep_2002ws"    "n_dep_2007ws"    "n_dep_2012ws"    "n_dep_2017ws"</span></span></code></pre></div>
<p>Transform sc_get_nni dataframe into long dataframe</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nin</span> <span class="op">&lt;-</span> <span class="va">cuyahoga</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^(n)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cuyahoga</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span> </span>
<span>                  <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"(cr)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cuyahoga</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span> </span>
<span>                  <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"(ags)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cuyahoga</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span> </span>
<span>                  <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"(leg)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cuyahoga</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">nin</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">nin</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">col</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">col</span>, <span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span> <span class="op">-</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">nin</span> <span class="op">&lt;-</span> <span class="va">nin</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"metric"</span>, <span class="st">"year"</span><span class="op">)</span>,</span>
<span>    names_sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"value"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pin</span> <span class="op">&lt;-</span> <span class="va">cuyahoga</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^(p)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cuyahoga</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span> </span>
<span>                  <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"(cr)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cuyahoga</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span> </span>
<span>                  <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"(ags)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cuyahoga</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span> </span>
<span>                  <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"(leg)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cuyahoga</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pin</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pin</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">col</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">col</span>, <span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span> <span class="op">-</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">pin</span> <span class="op">&lt;-</span> <span class="va">pin</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"metric"</span>, <span class="st">"year"</span><span class="op">)</span>,</span>
<span>    names_sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"value"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Pie Chart of Sources of N and P to the Cuyahoga River in 2012</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n2012</span> <span class="op">&lt;-</span> <span class="va">nin</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="st">'2012'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2012</span> <span class="op">&lt;-</span> <span class="va">pin</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="st">'2012'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">colorsn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'ff'</span> <span class="op">=</span> <span class="st">'#A3CC51'</span>, <span class="st">'lw'</span><span class="op">=</span><span class="st">'#B26F2C'</span>,<span class="st">'hw'</span><span class="op">=</span><span class="st">'#E51932'</span>,<span class="st">'uf'</span><span class="op">=</span><span class="st">'black'</span>, <span class="st">'dep'</span><span class="op">=</span><span class="st">'#6db6ff'</span>, <span class="st">'cf'</span><span class="op">=</span><span class="st">'#FFD700'</span>, <span class="st">'usgsww'</span> <span class="op">=</span> <span class="st">'pink'</span><span class="op">)</span></span>
<span><span class="va">colorsp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'ff'</span> <span class="op">=</span> <span class="st">'#A3CC51'</span>, <span class="st">'lw'</span><span class="op">=</span><span class="st">'#B26F2C'</span>,<span class="st">'hw'</span><span class="op">=</span><span class="st">'#E51932'</span>,<span class="st">'uf'</span><span class="op">=</span><span class="st">'black'</span>, <span class="st">'usgsww'</span> <span class="op">=</span> <span class="st">'pink'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">nin</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">metric</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_radial.html" class="external-link">coord_polar</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">colorsn</span>, labels <span class="op">=</span> </span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'ff'</span> <span class="op">=</span> <span class="st">'Farm Fertilizer'</span>,</span>
<span>                         <span class="st">'uf'</span> <span class="op">=</span> <span class="st">'Urban Fertilizer'</span>,</span>
<span>                         <span class="st">'hw'</span> <span class="op">=</span> <span class="st">'Human Waste'</span>,</span>
<span>                         <span class="st">'lw'</span> <span class="op">=</span> <span class="st">'Livestock Waste'</span>,</span>
<span>                         <span class="st">'dep'</span> <span class="op">=</span> <span class="st">'Total Deposition'</span>,</span>
<span>                         <span class="st">'usgsww'</span> <span class="op">=</span> <span class="st">'Point Source Loads'</span>,</span>
<span>                         <span class="st">'cf'</span> <span class="op">=</span> <span class="st">'Crop N-Fixation'</span><span class="op">)</span></span>
<span>                     <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Nitrogen"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">'Source'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">pin</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">metric</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_radial.html" class="external-link">coord_polar</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">colorsp</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Phosphorus"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">'none'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n</span> <span class="op">+</span> <span class="va">p</span> <span class="op">+</span> <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="NNI_files/figure-html/unnamed-chunk-7-1.png" class="r-plt" alt="" width="700"></p>
<p>Percent change of N and P inputs from 1992 to 2017</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nperc</span> <span class="op">&lt;-</span> <span class="va">nin</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'1992'</span>, <span class="st">'2017'</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>values_from <span class="op">=</span> <span class="st">'value'</span>,</span>
<span>              names_from <span class="op">=</span> <span class="st">'year'</span><span class="op">)</span></span>
<span><span class="va">nperc</span><span class="op">$</span><span class="va">perchange</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">nperc</span><span class="op">$</span><span class="va">`2017`</span> <span class="op">-</span> <span class="va">nperc</span><span class="op">$</span><span class="va">`1992`</span><span class="op">)</span> <span class="op">/</span> <span class="va">nperc</span><span class="op">$</span><span class="va">`1992`</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="va">nperc</span> <span class="op">&lt;-</span> <span class="va">nperc</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">metric</span>, <span class="va">perchange</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">metric</span> <span class="op">!=</span> <span class="st">'usgsww'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="st">'Source'</span> <span class="op">=</span> <span class="st">'metric'</span>, <span class="st">'Nitrogen Percent Change'</span> <span class="op">=</span> <span class="st">'perchange'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pperc</span> <span class="op">&lt;-</span> <span class="va">pin</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'1992'</span>, <span class="st">'2017'</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>values_from <span class="op">=</span> <span class="st">'value'</span>,</span>
<span>              names_from <span class="op">=</span> <span class="st">'year'</span><span class="op">)</span></span>
<span><span class="va">pperc</span><span class="op">$</span><span class="va">perchange</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">pperc</span><span class="op">$</span><span class="va">`2017`</span> <span class="op">-</span> <span class="va">pperc</span><span class="op">$</span><span class="va">`1992`</span><span class="op">)</span> <span class="op">/</span> <span class="va">pperc</span><span class="op">$</span><span class="va">`1992`</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="va">pperc</span> <span class="op">&lt;-</span> <span class="va">pperc</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">metric</span>, <span class="va">perchange</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">metric</span> <span class="op">!=</span> <span class="st">'usgsww'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="st">'Source'</span> <span class="op">=</span> <span class="st">'metric'</span>, <span class="st">'Phosphorus Percent Change'</span> <span class="op">=</span> <span class="st">'perchange'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">perc</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">nperc</span>, <span class="va">pperc</span>, by <span class="op">=</span> <span class="st">'Source'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">perc</span> <span class="op">&lt;-</span> <span class="va">perc</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>  Source <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">Source</span> <span class="op">==</span> <span class="st">'ff'</span> <span class="op">~</span> <span class="st">'Farm Fertilizer'</span>,</span>
<span>    <span class="va">Source</span> <span class="op">==</span> <span class="st">'uf'</span> <span class="op">~</span> <span class="st">'Urban Fertilizer'</span>,</span>
<span>    <span class="va">Source</span> <span class="op">==</span> <span class="st">'lw'</span> <span class="op">~</span> <span class="st">'Livestock Waste'</span>,</span>
<span>    <span class="va">Source</span> <span class="op">==</span> <span class="st">'cf'</span> <span class="op">~</span> <span class="st">'Crop N-Fixation'</span>,</span>
<span>    <span class="va">Source</span> <span class="op">==</span> <span class="st">'dep'</span> <span class="op">~</span> <span class="st">'Atmos. Deposition'</span>,</span>
<span>    <span class="va">Source</span> <span class="op">==</span> <span class="st">'hw'</span> <span class="op">~</span> <span class="st">'Human Waste'</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="va">perc</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   Source            `Nitrogen Percent Change` `Phosphorus Percent Change`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Farm Fertilizer                        6.09                      -<span style="color: #BB0000;">0.847</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Urban Fertilizer                     182.                        66.6  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Livestock Waste                      -<span style="color: #BB0000;">13.1</span>                      -<span style="color: #BB0000;">15.3</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Crop N-Fixation                       55.0                       <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Human Waste                           -<span style="color: #BB0000;">4.59</span>                     -<span style="color: #BB0000;">43.0</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Atmos. Deposition                    -<span style="color: #BB0000;">31.7</span>                       <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<p>Local catchment and watershed N and P inputs to the Platte River
Basin</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">com</span> <span class="op">&lt;-</span> <span class="fl">17416474</span></span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="fu"><a href="../../reference/sc_get_nni.html">sc_get_nni</a></span><span class="op">(</span>year<span class="op">=</span><span class="st">'2017'</span>, comid<span class="op">=</span><span class="va">com</span>, aoi<span class="op">=</span><span class="st">'cat,ws'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 37</span></span></span>
<span><span class="co">#&gt;      comid n_ff_2017cat n_ff_2017ws p_ff_2017cat p_ff_2017ws n_uf_2017cat</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 17<span style="text-decoration: underline;">416</span>474       <span style="text-decoration: underline;">29</span>206.  451<span style="text-decoration: underline;">370</span>919.        <span style="text-decoration: underline;">4</span>652.   68<span style="text-decoration: underline;">351</span>881.        <span style="text-decoration: underline;">2</span>715.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 31 more variables: n_uf_2017ws &lt;dbl&gt;, p_uf_2017cat &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   p_uf_2017ws &lt;dbl&gt;, n_lw_2017cat &lt;dbl&gt;, n_lw_2017ws &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   n_cr_2017cat &lt;dbl&gt;, n_cr_2017ws &lt;dbl&gt;, p_cr_2017cat &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   p_cr_2017ws &lt;dbl&gt;, n_ags_2017cat &lt;dbl&gt;, n_ags_2017ws &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   p_ags_2017cat &lt;dbl&gt;, p_ags_2017ws &lt;dbl&gt;, n_cf_2017cat &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   n_cf_2017ws &lt;dbl&gt;, p_lw_2017cat &lt;dbl&gt;, p_lw_2017ws &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   n_hw_2017cat &lt;dbl&gt;, n_hw_2017ws &lt;dbl&gt;, p_hw_2017cat &lt;dbl&gt;, …</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot-a-single-nni-metric-for-a-given-watershed">Plot a single NNI metric for a given watershed<a class="anchor" aria-label="anchor" href="#plot-a-single-nni-metric-for-a-given-watershed"></a>
</h2>
<p>In this example we access a single National Nutrient Inventory (NNI)
metric for the Calapooia River basin using the <code>sc_get_data</code>
function. We use the <code>nhdplusTools</code> library to pull in
flowlines and the watershed boundary for the Calapooia River basin, plot
the selected NNI metric for the Calapooia River and show the
watershed.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">start_comid</span> <span class="op">=</span> <span class="fl">23763517</span></span>
<span><span class="va">nldi_feature</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>featureSource <span class="op">=</span> <span class="st">"comid"</span>, featureID <span class="op">=</span> <span class="va">start_comid</span><span class="op">)</span></span>
<span></span>
<span><span class="va">flowline_nldi</span> <span class="op">&lt;-</span> <span class="fu">nhdplusTools</span><span class="fu">::</span><span class="fu"><a href="https://doi-usgs.github.io/nhdplusTools/reference/navigate_nldi.html" class="external-link">navigate_nldi</a></span><span class="op">(</span><span class="va">nldi_feature</span>, mode <span class="op">=</span> <span class="st">"UT"</span>, data_source <span class="op">=</span> <span class="st">"flowlines"</span>, distance<span class="op">=</span><span class="fl">5000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get StreamCat metrics</span></span>
<span><span class="va">comids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">flowline_nldi</span><span class="op">$</span><span class="va">UT_flowlines</span><span class="op">$</span><span class="va">nhdplus_comid</span><span class="op">)</span>, collapse<span class="op">=</span><span class="st">","</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sc_get_data.html">sc_get_data</a></span><span class="op">(</span>metric<span class="op">=</span><span class="st">'n_ff_2016'</span>, aoi<span class="op">=</span><span class="st">'cat'</span>, comid<span class="op">=</span><span class="va">comids</span>, showAreaSqKm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">flowline_nldi</span> <span class="op">&lt;-</span> <span class="va">flowline_nldi</span><span class="op">$</span><span class="va">UT_flowlines</span></span>
<span><span class="va">flowline_nldi</span><span class="op">$</span><span class="va">Farm_Nitrogon_2016</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">n_ff_2016cat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">flowline_nldi</span><span class="op">$</span><span class="va">nhdplus_comid</span>, <span class="va">df</span><span class="op">$</span><span class="va">comid</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">basin</span> <span class="op">&lt;-</span> <span class="fu">nhdplusTools</span><span class="fu">::</span><span class="fu"><a href="https://doi-usgs.github.io/nhdplusTools/reference/get_nldi_basin.html" class="external-link">get_nldi_basin</a></span><span class="op">(</span>nldi_feature <span class="op">=</span> <span class="va">nldi_feature</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="map-the-results">Map the Results<a class="anchor" aria-label="anchor" href="#map-the-results"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://paleolimbot.github.io/ggspatial/" class="external-link">ggspatial</a></span><span class="op">)</span></span>
<span><span class="va">flowline_nldi</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">Farm_Nitrogon_2016</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Spectral"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Kg Nitrogen"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">'Farm Nitrogen at the Catchment Scale for \nthe Calapooia River Basin 2016'</span><span class="op">)</span></span></code></pre></div>
<p><img src="NNI_files/figure-html/map1-1.png" class="r-plt" alt="" width="700"></p>
</div>
<div class="section level2">
<h2 id="look-at-change-through-time-calapooia-farm-nitrogen">Look at change through time Calapooia Farm Nitrogen<a class="anchor" aria-label="anchor" href="#look-at-change-through-time-calapooia-farm-nitrogen"></a>
</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sc_get_data.html">sc_get_data</a></span><span class="op">(</span>metric<span class="op">=</span><span class="st">'n_ff_1987'</span>, aoi<span class="op">=</span><span class="st">'cat'</span>, comid<span class="op">=</span><span class="va">comids</span><span class="op">)</span></span>
<span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sc_get_data.html">sc_get_data</a></span><span class="op">(</span>metric<span class="op">=</span><span class="st">'n_ff_2017'</span>, aoi<span class="op">=</span><span class="st">'cat'</span>, comid<span class="op">=</span><span class="va">comids</span><span class="op">)</span></span>
<span><span class="va">df2</span><span class="op">$</span><span class="va">n_ff_1987cat</span> <span class="op">&lt;-</span> <span class="va">df1</span><span class="op">$</span><span class="va">n_ff_1987cat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">df2</span><span class="op">$</span><span class="va">comid</span>, <span class="va">df1</span><span class="op">$</span><span class="va">comid</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">df2</span><span class="op">$</span><span class="va">Farm_Nitrogen_Difference</span> <span class="op">&lt;-</span> <span class="va">df2</span><span class="op">$</span><span class="va">n_ff_2017cat</span><span class="op">-</span><span class="va">df2</span><span class="op">$</span><span class="va">n_ff_1987cat</span></span>
<span><span class="va">flowline_nldi</span><span class="op">$</span><span class="va">Farm_Nitrogen_Difference</span> <span class="op">&lt;-</span> <span class="va">df2</span><span class="op">$</span><span class="va">Farm_Nitrogen_Difference</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">flowline_nldi</span><span class="op">$</span><span class="va">nhdplus_comid</span>, <span class="va">df2</span><span class="op">$</span><span class="va">comid</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="map-the-results-1">Map the Results<a class="anchor" aria-label="anchor" href="#map-the-results-1"></a>
</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flowline_nldi</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">Farm_Nitrogen_Difference</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Kg Nitrogen"</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Spectral"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">'Farm Nitrogen Change at the Catchment Scale for \nthe Calapooia River Basin from 1987 to 2017'</span><span class="op">)</span></span></code></pre></div>
<p><img src="NNI_files/figure-html/map2-1.png" class="r-plt" alt="" width="700"></p>
</div>
<div class="section level2">
<h2 id="crop-fixation-for-the-calapooia-watershed">Crop Fixation for the Calapooia Watershed<a class="anchor" aria-label="anchor" href="#crop-fixation-for-the-calapooia-watershed"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>scipen<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co"># get StreamCat metrics</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sc_get_data.html">sc_get_data</a></span><span class="op">(</span>metric<span class="op">=</span><span class="st">'n_cf_2017'</span>, aoi<span class="op">=</span><span class="st">'ws'</span>, comid<span class="op">=</span><span class="va">comids</span><span class="op">)</span></span>
<span></span>
<span><span class="va">flowline_nldi</span><span class="op">$</span><span class="va">CropNFixation</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">n_cf_2017ws</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">flowline_nldi</span><span class="op">$</span><span class="va">nhdplus_comid</span>, <span class="va">df</span><span class="op">$</span><span class="va">comid</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="map-the-results-2">Map the Results<a class="anchor" aria-label="anchor" href="#map-the-results-2"></a>
</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flowline_nldi</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">CropNFixation</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Spectral"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"Kg Nitrogen"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">'Watershed Crop Nitrogen Fixation \nfor the Calapooia River Basin 2017'</span><span class="op">)</span></span></code></pre></div>
<p><img src="NNI_files/figure-html/map3-1.png" class="r-plt" alt="" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marc Weber.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
